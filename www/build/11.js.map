{"version":3,"sources":["../../src/pages/password-community/password-community.module.ts","../../src/pages/password-community/password-community.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAAuC;AACO;AACa;AAa3D;IAAA;IAA0C,CAAC;IAA9B,2BAA2B;QAXvC,+DAAQ,CAAC;YACR,YAAY,EAAE;gBACZ,kFAAqB;aACtB;YACD,OAAO,EAAE;gBACP,sEAAe,CAAC,QAAQ,CAAC,kFAAqB,CAAC;aAChD;YACD,OAAO,EAAE;gBACP,kFAAqB;aACtB;SACF,CAAC;OACW,2BAA2B,CAAG;IAAD,kCAAC;CAAA;AAAH;;;;;;;;;;;;;;;;;;;;;;;;ACfA;AAC8F;AACvG;AACuC;AAEtE;;;;;GAKG;AAMH;IAWE,+BAAmB,OAAsB,EAChC,SAAoB,EACnB,IAAoB,EACrB,gBAAmC,EAClC,KAAsB,EACvB,WAA8B,EAC9B,QAAgB,EAChB,SAA0B;QAPhB,YAAO,GAAP,OAAO,CAAe;QAChC,cAAS,GAAT,SAAS,CAAW;QACnB,SAAI,GAAJ,IAAI,CAAgB;QACrB,qBAAgB,GAAhB,gBAAgB,CAAmB;QAClC,UAAK,GAAL,KAAK,CAAiB;QACvB,gBAAW,GAAX,WAAW,CAAmB;QAC9B,aAAQ,GAAR,QAAQ,CAAQ;QAChB,cAAS,GAAT,SAAS,CAAiB;QAf5B,aAAQ,GAAG,EAAE,CAAC;QACd,kBAAa,GAAG,KAAK,CAAC;QACtB,gBAAW,GAAG,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC,CAAC;QAE9D,eAAU,GAAG,IAAI,CAAC;QAClB,aAAQ,GAAG,KAAK,CAAC;QAWtB,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC;QAC1C,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;YACrB,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;SACzB;QACD,IAAI,CAAC,WAAW,GAAG,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;QACvC,IAAI,CAAC,aAAa,GAAG,SAAS,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;IAC7C,CAAC;IAED,qCAAK,GAAL;QACE,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;IACtB,CAAC;IAED,6CAAa,GAAb;QAAA,iBAqCC;QApCC,IAAI,CAAC,aAAa,GAAG,KAAK,CAAC;QAC3B,IAAI,IAAI,CAAC,QAAQ,IAAI,EAAE,EAAE;YACvB,IAAI,cAAY,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;YAC/C,IAAI,CAAC,gBAAgB,CAAC,0BAA0B,CAAC,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,cAAI;gBACzF,cAAY,CAAC,OAAO,EAAE,CAAC;gBACvB,IAAI,IAAI,CAAC,OAAO,EAAE;oBAChB,OAAO,CAAC,GAAG,CAAC,CAAC,KAAI,CAAC,gBAAgB,CAAC,wBAAwB,EAAE,EAAE,KAAI,CAAC,gBAAgB,CAAC,0BAA0B,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,cAAI;wBAC3H,YAAY,CAAC,OAAO,CAAC,oBAAoB,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;wBACpE,KAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,oBAAoB,CAAC,CAAC;wBAC5C,YAAY,CAAC,OAAO,CAAC,wBAAwB,EAAE,MAAM,CAAC,CAAC;wBACvD,YAAY,CAAC,OAAO,CAAC,gBAAgB,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;wBAChE,KAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,4BAA4B,CAAC,CAAC;wBACpD,KAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,oBAAoB,CAAC,CAAC;oBAG9C,CAAC,CAAC,CAAC;oBACH,KAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;oBACpB,IAAM,QAAQ,GAAG,KAAI,CAAC,KAAK,CAAC,MAAM,CAAC,WAAW,EAAE,EAAE,SAAS,EAAE,0DAA0D,EAAE,EAAE,EAAE,QAAQ,EAAE,eAAe,EAAE,CAAC,CAAC;oBAC1J,QAAQ,CAAC,YAAY,CAAC;oBACtB,CAAC,CAAC,CAAC;oBACH,QAAQ,CAAC,OAAO,EAAE,CAAC;iBAEpB;qBAAM;oBAEL,KAAI,CAAC,aAAa,GAAG,IAAI,CAAC;iBAC3B;YAEH,CAAC,EACC,aAAG;gBACD,KAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,aAAa,EAAE,GAAG,CAAC,CAAC;gBAC1C,cAAY,CAAC,OAAO,EAAE,CAAC;YACzB,CAAC,CAAC,CAAC;SAEN;IAGH,CAAC;IACD,2CAAW,GAAX;QAAA,iBA6BC;QA5BC,IAAI,WAAW,GAAG,eAAe,CAAC;QAClC,IAAI,IAAI,CAAC,QAAQ,IAAI,EAAE,EAAE;YACvB,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;SAC3B;aAAM,IAAI,IAAI,CAAC,WAAW,IAAI,EAAE,EAAE;YACjC,IAAI,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,EAAE;gBACtC,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;gBACpB,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;gBACtB,IAAI,cAAY,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;gBAC/C,IAAI,CAAC,gBAAgB,CAAC,mBAAmB,CAAC,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,cAAI;oBACrF,cAAY,CAAC,OAAO,EAAE,CAAC;oBACvB,IAAM,QAAQ,GAAG,KAAI,CAAC,KAAK,CAAC,MAAM,CAAC,WAAW,EAAE,EAAE,SAAS,EAAE,iGAAiG,EAAE,EAAE,EAAE,QAAQ,EAAE,eAAe,EAAE,CAAC,CAAC;oBACjM,QAAQ,CAAC,YAAY,CAAC;oBACtB,CAAC,CAAC,CAAC;oBACH,QAAQ,CAAC,OAAO,EAAE,CAAC;gBACrB,CAAC,EACC,aAAG;oBACD,KAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,aAAa,EAAE,GAAG,CAAC,CAAC;oBAC1C,cAAY,CAAC,OAAO,EAAE,CAAC;gBACzB,CAAC,CAAC,CAAC;aAEN;iBACI;gBACH,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;aACtB;SACF;aACI;YACH,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;SACtB;IACH,CAAC;IAlGU,qBAAqB;QAJjC,gEAAS,CAAC;YACT,QAAQ,EAAE,yBAAyB;WACG;SACvC,CAAC;6EAYyC;YACrB,qEAAS;YACb,yFAAc;YACH,uEAAiB;YAC3B,wEAAe;YACV,8DAAiB;YACpB,sEAAM;YACL,eAAe;OAlBxB,qBAAqB,CAmGjC;IAAD,CAAC;AAAA;SAnGY,qBAAqB,gB","file":"11.js","sourcesContent":["import {NgModule} from \"@angular/core\";\r\nimport {IonicPageModule} from \"ionic-angular\";\r\nimport {PasswordCommunityPage} from \"./password-community\";\r\n\r\n@NgModule({\r\n  declarations: [\r\n    PasswordCommunityPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(PasswordCommunityPage),\r\n  ],\r\n  exports: [\r\n    PasswordCommunityPage\r\n  ]\r\n})\r\nexport class PasswordCommunityPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/password-community/password-community.module.ts","import {Component} from \"@angular/core\";\r\nimport {\r\n    AlertController,\r\n    Events,\r\n    IonicPage,\r\n    LoadingController,\r\n    ModalController,\r\n    NavController,\r\n    NavParams,\r\n    ViewController\r\n} from \"ionic-angular\";\r\nimport \"rxjs/add/operator/map\";\r\nimport {CommunityProvider} from \"../../providers/community/community\";\r\n\r\n/**\r\n * Generated class for the PasswordCommunityPage page.\r\n *\r\n * See http://ionicframework.com/docs/components/#navigation for more info\r\n * on Ionic pages and navigation.\r\n */\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-password-community',\r\n  templateUrl: 'password-community.html',\r\n})\r\nexport class PasswordCommunityPage {\r\n  public communityId: any;\r\n  public communityName: any;\r\n  public password = \"\";\r\n  public falsePassword = false;\r\n  public currentUser = JSON.parse(localStorage.getItem(\"currentUser\"));\r\n  public phoneNumber: any;\r\n  public isDisabled = true;\r\n  public badPhone = false;\r\n\r\n\r\n  constructor(public navCtrl: NavController,\r\n    public navParams: NavParams,\r\n    private view: ViewController,\r\n    public serviceCommunity: CommunityProvider,\r\n    private modal: ModalController,\r\n    public loadingCtrl: LoadingController,\r\n    public appEvent: Events,\r\n    public alertCtrl: AlertController) {\r\n    this.phoneNumber = this.currentUser.phone;\r\n    if (!this.phoneNumber) {\r\n      this.isDisabled = false;\r\n    }\r\n    this.communityId = navParams.get('id');\r\n    this.communityName = navParams.get('name');\r\n  }\r\n\r\n  Close() {\r\n    this.view.dismiss();\r\n  }\r\n\r\n  checkPassword() {\r\n    this.falsePassword = false;\r\n    if (this.password != '') {\r\n      let loadingPopup = this.loadingCtrl.create({});\r\n      this.serviceCommunity.postUserPrivateCommunities(this.communityId, this.password).then(data => {\r\n        loadingPopup.dismiss();\r\n        if (data.success) {\r\n          Promise.all([this.serviceCommunity.getAllPrivateCommunities(), this.serviceCommunity.findCurrentUserCommunities()]).then(user => {\r\n            localStorage.setItem(\"privateCommunities\", JSON.stringify(user[0]));\r\n            this.appEvent.publish('refreshCommunities');\r\n            localStorage.setItem(\"hasApprovedCommunities\", \"true\");\r\n            localStorage.setItem(\"allCommunities\", JSON.stringify(user[1]));\r\n            this.appEvent.publish('refreshApprovedCommunities');\r\n            this.appEvent.publish('refreshCommunities');\r\n\r\n\r\n          });\r\n          this.view.dismiss();\r\n          const myModal2 = this.modal.create('PopupPage', { \"message\": \"<p>C'est parfait. Bienvenue dans cette communauté ! </p>\" }, { cssClass: 'message-modal' });\r\n          myModal2.onDidDismiss(() => {\r\n          });\r\n          myModal2.present();\r\n\r\n        } else {\r\n\r\n          this.falsePassword = true;\r\n        }\r\n\r\n      },\r\n        err => {\r\n          this.appEvent.publish('http:errors', err);\r\n          loadingPopup.dismiss();\r\n        });\r\n\r\n    }\r\n\r\n\r\n  }\r\n  sendRequest() {\r\n    var phoneRegexp = /^(33|0)\\d{9}$/;\r\n    if (this.password == '') {\r\n      this.falsePassword = true;\r\n    } else if (this.phoneNumber != '') {\r\n      if (phoneRegexp.test(this.phoneNumber)) {\r\n        this.view.dismiss();\r\n        this.badPhone = false;\r\n        let loadingPopup = this.loadingCtrl.create({});\r\n        this.serviceCommunity.postPasswordRequest(this.communityId, this.phoneNumber).then(data => {\r\n          loadingPopup.dismiss();\r\n          const myModal2 = this.modal.create('PopupPage', { \"message\": \"<p>C'est parfait. Votre demande d’accès a été envoyée à l’administrateur de la communauté. </p>\" }, { cssClass: 'message-modal' });\r\n          myModal2.onDidDismiss(() => {\r\n          });\r\n          myModal2.present();\r\n        },\r\n          err => {\r\n            this.appEvent.publish('http:errors', err);\r\n            loadingPopup.dismiss();\r\n          });\r\n\r\n      }\r\n      else {\r\n        this.badPhone = true;\r\n      }\r\n    }\r\n    else {\r\n      this.badPhone = true;\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/password-community/password-community.ts"],"sourceRoot":""}